<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Bank</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-image: url('https://via.placeholder.com/1500x1000?text=Credit+Cards');
      background-size: cover;
      background-position: center;
    }
  </style>
</head>
<body class="flex justify-center items-center h-screen p-4 bg-[url('https://t4.ftcdn.net/jpg/08/81/87/47/360_F_881874797_hyH8aO24AU6Bg39Vju2g69Rb4r3zmxBL.jpg')]">

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-4xl">
    <!-- Deposit Section -->
    <div class="bg-white p-4 rounded-lg shadow-lg">
      <h2 class="text-xl text-green-700 font-semibold">Deposit</h2>
      <div class="mt-2 text-gray-600">
        <p>Enter Your Amount</p>
        <input type="text" id="block1" class="w-full p-2 mt-1 border border-green-300 rounded" placeholder="Enter amount">
        <p class="mt-2">Enter Your Password</p>
        <input type="password" id="block2" class="w-full p-2 mt-1 border border-green-300 rounded" placeholder="Enter password">
      </div>
      <button type="button" onclick="deposit()" class="mt-4 bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800">Deposit</button>
    </div>

    <!-- Withdraw Section -->
    <div class="bg-white p-4 rounded-lg shadow-lg">
      <h2 class="text-xl text-green-700 font-semibold">Withdraw</h2>
      <div class="mt-2 text-gray-600">
        <p>Enter Your Amount</p>
        <input type="text" id="block3" class="w-full p-2 mt-1 border border-green-300 rounded" placeholder="Enter amount">
        <p class="mt-2">Enter Your Password</p>
        <input type="password" id="block4" class="w-full p-2 mt-1 border border-green-300 rounded" placeholder="Enter password">
      </div>
      <button type="button" onclick="withdraw()" class="mt-4 bg-green-700 text-white px-4 py-2 rounded hover:bg-green-800">Withdraw</button>
    </div>

    <!-- Transaction History Section -->
    <div class="bg-white p-4 rounded-lg shadow-lg col-span-2">
      <h2 class="text-xl text-green-700 font-semibold">Transaction History</h2>
      <div class="mt-2">
        <div class="bg-green-700 text-white p-2 flex justify-between font-semibold">
          <span>Date</span>
          <span>Type</span>
          <span>Amount</span>
          <span>Balance</span>
        </div>
        <div id="transactionHistory"></div>
      </div>
    </div>
  </div>

  <script>
    function formatDate(date) {
      return date.toLocaleString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      });
    }

    function loadTransactionHistory(accountNumber) {
      const transactions = JSON.parse(localStorage.getItem(accountNumber + '_transactions') || '[]');
      const historyDiv = document.getElementById('transactionHistory');
      historyDiv.innerHTML = '';
      transactions.forEach(tx => {
        const row = document.createElement('div');
        row.className = 'flex justify-between p-2 border-b';
        row.innerHTML = `
          <span>${tx.date}</span>
          <span>${tx.type}</span>
          <span>${tx.amount}</span>
          <span>${tx.balance}</span>
        `;
        historyDiv.appendChild(row);
      });
    }

    function deposit() {
      const amount = document.getElementById('block1').value;
      const password = document.getElementById('block2').value;
      const urlparams = new URLSearchParams(window.location.search);
      const accountNumber = urlparams.get('accountNumber');
      if (!accountNumber) {
        alert('Account number is missing in the URL.');
        return;
      }
      const detail = localStorage.getItem(accountNumber);
      if (!detail) {
        alert('Account not found.');
        return;
      }

      if (amount && password) {
        const data = JSON.parse(detail);
        if (password === data.password) {
          const balance = Number(data.balance || 0) + Number(amount);
          const account = {
            id: accountNumber,
            balance: balance,
            password: data.password
          };
          localStorage.setItem(accountNumber, JSON.stringify(account));

          // Add to transaction history
          const transactions = JSON.parse(localStorage.getItem(accountNumber + '_transactions') || '[]');
          transactions.push({
            date: formatDate(new Date()),
            type: 'Deposit',
            amount: Number(amount).toFixed(2),
            balance: balance.toFixed(2)
          });
          localStorage.setItem(accountNumber + '_transactions', JSON.stringify(transactions));

          alert("Deposit Successful");
          loadTransactionHistory(accountNumber);
          document.getElementById('block1').value = '';
          document.getElementById('block2').value = '';
        } else {
          alert('Incorrect password.');
        }
      } else {
        alert('Please enter both amount and password.');
      }
    }

    function withdraw() {
      const amount = document.getElementById('block3').value;
      const password = document.getElementById('block4').value;
      const urlparams = new URLSearchParams(window.location.search);
      const accountNumber = urlparams.get('accountNumber');
      const detail = localStorage.getItem(accountNumber);
      if (!detail) {
        alert('Account not found.');
        return;
      }
      const data = JSON.parse(detail);
      if (amount && password) {
        if (password === data.password) {
          if (Number(amount) <= Number(data.balance)) {
            const balance = Number(data.balance || 0) - Number(amount);
            localStorage.setItem(accountNumber, JSON.stringify({ ...data, balance: balance }));

            // Add to transaction history
            const transactions = JSON.parse(localStorage.getItem(accountNumber + '_transactions') || '[]');
            transactions.push({
              date: formatDate(new Date()),
              type: 'Withdraw',
              amount: Number(amount).toFixed(2),
              balance: balance.toFixed(2)
            });
            localStorage.setItem(accountNumber + '_transactions', JSON.stringify(transactions));

            alert("Withdraw Successful");
            loadTransactionHistory(accountNumber);
            document.getElementById('block3').value = '';
            document.getElementById('block4').value = '';
          } else {
            alert("Insufficient Balance");
          }
        } else {
          alert('Incorrect password.');
        }
      } else {
        alert('Please enter both amount and password.');
      }
    }

    // Load transaction history on page load
    window.onload = function() {
      const urlparams = new URLSearchParams(window.location.search);
      const accountNumber = urlparams.get('accountNumber');
      if (accountNumber) {
        loadTransactionHistory(accountNumber);
      }
    };
  </script>
</body>
</html>